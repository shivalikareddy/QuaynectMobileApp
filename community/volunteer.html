<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Opportunities - Community Hub</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#3B82F6",
                        "primary-dark": "#2563EB",
                        "background-light": "#F8F9FB",
                        "background-dark": "#111827",
                        "card-light": "#FFFFFF",
                        "card-dark": "#1F2937",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                        body: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "1rem",
                    },
                },
            },
        };
    </script>
    <style>
        .ios-blur {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Bookings Header Style */
        .bookings-header {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px; /* Matching app-container max-width */
            z-index: 100;
            padding: calc(16px + env(safe-area-inset-top, 0px)) 20px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(248, 249, 251, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid #F1F5F9;
            transition: all 0.3s ease;
        }

        .bookings-header .back-btn,
        .bookings-header .header-action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #FFFFFF;
            border: 1px solid #F1F5F9;
            font-size: 22px;
            cursor: pointer;
            color: #1A1C1E;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s, background-color 0.2s;
            flex-shrink: 0;
            text-decoration: none;
        }

        .bookings-header .header-title {
            color: #1A1C1E;
            font-size: 28px;
            font-weight: 700;
            text-align: left;
            flex-grow: 1;
            margin-left: 16px;
            letter-spacing: -0.5px;
        }

        /* Dark mode for header */
        .dark .bookings-header {
            background: rgba(17, 24, 39, 0.9);
            border-color: #374151;
        }
        .dark .bookings-header .back-btn,
        .dark .bookings-header .header-action-btn {
            background: #1F2937;
            border-color: #374151;
            color: #F8F9FB;
        }
        .dark .bookings-header .header-title {
            color: #F8F9FB;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-body text-gray-900 dark:text-gray-100 antialiased min-h-screen">
<div class="app-container relative overflow-hidden flex flex-col">
    <!-- Header -->
    <header class="bookings-header">
        <a href="index.html" class="back-btn">
            <ion-icon name="chevron-back-outline"></ion-icon>
        </a>
        <h1 class="header-title">Opportunities</h1>
        <button class="header-action-btn">
            <ion-icon name="search-outline"></ion-icon>
        </button>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto px-5 space-y-6 pb-24 pt-[calc(76px+env(safe-area-inset-top,0px))]">
        <!-- Community Garden Coordinator -->
        <div class="group relative overflow-hidden rounded-3xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-sm transition-all hover:shadow-md">
            <div class="p-6 relative">
                <div class="flex items-center space-x-4 mb-4">
                    <div class="w-12 h-12 rounded-[24px] bg-green-50 dark:bg-green-900/30 flex items-center justify-center">
                        <span class="text-2xl">ü™¥</span>
                    </div>
                    <h2 class="text-xl font-bold dark:text-white">Community Garden Coordinator</h2>
                </div>
                <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-6">
                    Manage planting schedules and coordinate volunteers for the waterfront garden.
                </p>
            </div>
            <div class="backdrop-blur-xl bg-slate-50/50 dark:bg-slate-800/40 border-t border-slate-100 dark:border-slate-800/50 p-5 flex justify-between items-center">
                <div class="flex flex-col">
                    <span class="text-xs  tracking-wider text-slate-400 dark:text-slate-500 font-semibold mb-0.5">Commitment</span>
                    <span class="text-sm font-medium dark:text-slate-200">4-6 hours/week</span>
                </div>
                <button onclick="showDetails('garden')" class="bg-primary text-white px-5 py-2.5 rounded-xl text-sm font-semibold transition-all active:scale-95">
                    View Details
                </button>
            </div>
        </div>

        <!-- Event Support Volunteer -->
        <div class="group relative overflow-hidden rounded-3xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-sm transition-all hover:shadow-md">
            <div class="p-6 relative">
                <div class="flex items-center space-x-4 mb-4">
                    <div class="w-12 h-12 rounded-[24px] bg-orange-50 dark:bg-orange-900/30 flex items-center justify-center">
                        <span class="text-2xl">üóìÔ∏è</span>
                    </div>
                    <h2 class="text-xl font-bold dark:text-white">Event Support Volunteer</h2>
                </div>
                <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-6">
                    Assist with setup, registration, and logistics for community events.
                </p>
            </div>
            <div class="backdrop-blur-xl bg-slate-50/50 dark:bg-slate-800/40 border-t border-slate-100 dark:border-slate-800/50 p-5 flex justify-between items-center">
                <div class="flex flex-col">
                    <span class="text-xs  tracking-wider text-slate-400 dark:text-slate-500 font-semibold mb-0.5">Commitment</span>
                    <span class="text-sm font-medium dark:text-slate-200">Occasional weekends</span>
                </div>
                <button onclick="showDetails('event')" class="bg-primary text-white px-5 py-2.5 rounded-xl text-sm font-semibold transition-all active:scale-95">
                    View Details
                </button>
            </div>
        </div>

        <!-- Waterfront Cleanup Lead -->
        <div class="group relative overflow-hidden rounded-3xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 shadow-sm transition-all hover:shadow-md">

            <div class="p-6 relative">
                <div class="flex items-center space-x-4 mb-4">
                    <div class="w-12 h-12 rounded-[24px] bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center">
                        <span class="text-2xl">‚ôªÔ∏è</span>
                    </div>
                    <h2 class="text-xl font-bold dark:text-white">Waterfront Cleanup Lead</h2>
                </div>
                <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-6">
                    Organize and lead monthly cleanup drives along the harbor.
                </p>
            </div>
            <div class="backdrop-blur-xl bg-slate-50/50 dark:bg-slate-800/40 border-t border-slate-100 dark:border-slate-800/50 p-5 flex justify-between items-center">
                <div class="flex flex-col">
                    <span class="text-xs  tracking-wider text-slate-400 dark:text-slate-500 font-semibold mb-0.5">Commitment</span>
                    <span class="text-sm font-medium dark:text-slate-200">Monthly</span>
                </div>
                <button onclick="showDetails('cleanup')" class="bg-primary text-white px-5 py-2.5 rounded-xl text-sm font-semibold transition-all active:scale-95">
                    View Details
                </button>
            </div>
        </div>

        <!-- See All Positions Button -->
        <div class="pt-4 pb-8">
            <button class="w-full bg-primary text-white py-4 px-6 rounded-[24px] font-bold text-lg shadow-sm transition-all transform active:scale-[0.98]">
                See All Positions
            </button>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item">
            <a href="../index.html" style="text-decoration: none; color: inherit; display: flex; flex-direction: column; align-items: center;">
                <ion-icon name="home-outline"></ion-icon>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-item">
            <ion-icon name="construct-outline"></ion-icon>
            <span>Services</span>
        </div>
        <div class="nav-item active">
            <ion-icon name="chatbubble-ellipses"></ion-icon>
            <span>Messages</span>
        </div>
        <a href="../profile/profile.html" class="nav-item" style="text-decoration: none; color: inherit; display: flex; flex-direction: column; align-items: center;">
            <ion-icon name="person-circle-outline"></ion-icon>
            <span>Profile</span>
        </a>
    </nav>
</div>

<!-- Details Modal -->
<div id="detailsModal" class="fixed inset-0 z-50 hidden">
    <!-- Blurred Background -->
    <div class="fixed inset-0 bg-black/30 dark:bg-black/60" onclick="closeDetails()"></div>
    
    <!-- Modal Sheet -->
    <div id="modalSheet" class="fixed inset-x-0 bottom-0 h-[92vh] bg-white dark:bg-card-dark rounded-t-3xl shadow-2xl flex flex-col transition-transform duration-300">
        <!-- Handle -->
        <div id="modalHandle" class="w-full flex justify-center py-3 cursor-grab active:cursor-grabbing">
            <div class="w-10 h-1.5 bg-slate-300 dark:bg-zinc-700 rounded-full"></div>
        </div>
        
        <!-- Content -->
        <div class="flex-1 overflow-y-auto no-scrollbar px-5 pb-32">
            <!-- Title -->
            <div class="mb-6">
                <h2 id="modalTitle" class="text-2xl font-bold leading-tight mb-1 text-slate-900 dark:text-white"></h2>
                <p class="text-sm text-slate-500 dark:text-zinc-400">
                    Posted by: <span class="font-medium text-slate-700 dark:text-zinc-300">Quayside Community Association</span>
                </p>
            </div>
            
            <!-- Image -->
            <div class="mb-6 rounded-[24px] overflow-hidden shadow-sm aspect-[16/9]">
                <img id="modalImage" alt="Volunteer opportunity" class="w-full h-full object-cover"/>
            </div>
            
            <!-- Info Grid -->
            <div id="modalInfo" class="grid grid-cols-3 gap-3 mb-6"></div>
            
            <!-- Description -->
            <div class="mb-8">
                <h3 class="text-lg font-bold mb-3 text-slate-900 dark:text-white">Description</h3>
                <p id="modalDescription" class="text-[15px] leading-relaxed text-slate-600 dark:text-zinc-300"></p>
            </div>
            
            <!-- Requirements -->
            <div class="mb-8">
                <h3 class="text-lg font-bold mb-3 text-slate-900 dark:text-white">Requirements & Info</h3>
                <ul id="modalRequirements" class="space-y-3"></ul>
            </div>
            
            <!-- Bottom Button -->
            <div class="pt-4 pb-6">
                <button onclick="signUpVolunteer()" class="w-full bg-primary text-white font-semibold py-4 rounded-xl transition-all active:scale-[0.98]">
                    Sign Up to Volunteer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Sign Up Loading/Success Modal -->
<div id="signUpModal" class="fixed inset-0 z-50 hidden items-center justify-center">
    <div class="fixed inset-0 bg-black/50"></div>
    <div class="relative bg-white dark:bg-card-dark rounded-3xl p-8 mx-4 max-w-sm w-full shadow-2xl">
        <!-- Loading State -->
        <div id="loadingState" class="text-center">
            <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-2">Submitting...</h3>
            <p class="text-slate-600 dark:text-slate-400">Please wait while we process your application</p>
        </div>
        
        <!-- Success State -->
        <div id="successState" class="text-center hidden">
            <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <ion-icon name="checkmark-outline" class="text-white text-4xl"></ion-icon>
            </div>
            <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">Success!</h3>
            <p class="text-slate-600 dark:text-slate-400 mb-6">You've successfully signed up for this opportunity</p>
            <button onclick="closeSignUpModal()" class="w-full bg-primary text-white font-semibold py-3 rounded-xl transition-all active:scale-95">
                Done
            </button>
        </div>
    </div>
</div>

<!-- Confetti Canvas -->
<canvas id="confettiCanvas" class="fixed inset-0 pointer-events-none z-50 hidden"></canvas>

<script>
    const opportunityData = {
        garden: {
            title: "Community Garden Coordinator",
            image: "https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=800&h=450&fit=crop",
            date: "Ongoing",
            time: "Flexible Schedule",
            location: "Waterfront Garden, Quayside",
            commitment: "4-6 hours/week",
            description: "Help manage planting schedules and coordinate volunteers for our beautiful waterfront garden. You'll work alongside passionate community members to maintain and grow our urban green space, plan seasonal plantings, and organize volunteer gardening sessions.",
            requirements: [
                "Basic gardening knowledge helpful but not required",
                "Ability to work independently and with groups",
                "Comfortable working outdoors in various weather",
                "Strong organizational and communication skills"
            ]
        },
        event: {
            title: "Event Support Volunteer",
            image: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?w=800&h=450&fit=crop",
            date: "Varies by Event",
            time: "Event-dependent",
            location: "Various Locations, Quayside",
            commitment: "Occasional weekends",
            description: "Assist with setup, registration, and logistics for community events. From seasonal festivals to workshops and community gatherings, you'll help create memorable experiences for residents. Perfect for those who enjoy variety and meeting new people.",
            requirements: [
                "Friendly and welcoming demeanor",
                "Able to lift and carry light equipment",
                "Available for weekend events",
                "Comfortable with event technology and registration tools"
            ]
        },
        cleanup: {
            title: "Waterfront Cleanup Lead",
            image: "https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?w=800&h=450&fit=crop",
            date: "Last Saturday of Month",
            time: "9:00 AM - 12:00 PM",
            location: "Parliament Slip, Quayside",
            commitment: "Monthly",
            description: "Organize and lead monthly cleanup drives along the harbor. Help keep our beautiful waterfront clean and thriving by removing litter and maintaining naturalized areas. It's a great way to give back to the community while enjoying the outdoors.",
            requirements: [
                "Comfortable clothing and sturdy shoes recommended",
                "Leadership or coordination experience helpful",
                "All ages welcome (under 14 with guardian)",
                "Tools, gloves, and bags provided"
            ]
        }
    };

    function showDetails(type) {
        const data = opportunityData[type];
        const modal = document.getElementById('detailsModal');
        
        // Populate modal content
        document.getElementById('modalTitle').textContent = data.title;
        document.getElementById('modalImage').src = data.image;
        document.getElementById('modalDescription').textContent = data.description;
        
        // Populate info grid
        const infoGrid = document.getElementById('modalInfo');
        infoGrid.innerHTML = `
            <div class="bg-slate-50 dark:bg-slate-800/50 rounded-xl p-3 flex flex-col items-center text-center">
                <ion-icon name="calendar-outline" class="text-2xl text-primary mb-2"></ion-icon>
                <p class="text-xs text-slate-500 dark:text-slate-400 mb-1">Date & Time</p>
                <p class="text-sm font-semibold text-slate-900 dark:text-white leading-tight">${data.date}</p>
                <p class="text-xs text-slate-600 dark:text-slate-400 mt-0.5">${data.time}</p>
            </div>
            <div class="bg-slate-50 dark:bg-slate-800/50 rounded-xl p-3 flex flex-col items-center text-center">
                <ion-icon name="location-outline" class="text-2xl text-primary mb-2"></ion-icon>
                <p class="text-xs text-slate-500 dark:text-slate-400 mb-1">Location</p>
                <p class="text-sm font-semibold text-slate-900 dark:text-white leading-tight">${data.location}</p>
            </div>
            <div class="bg-slate-50 dark:bg-slate-800/50 rounded-xl p-3 flex flex-col items-center text-center">
                <ion-icon name="time-outline" class="text-2xl text-primary mb-2"></ion-icon>
                <p class="text-xs text-slate-500 dark:text-slate-400 mb-1">Commitment</p>
                <p class="text-sm font-semibold text-slate-900 dark:text-white leading-tight">${data.commitment}</p>
            </div>
        `;
        
        // Populate requirements
        const requirementsList = document.getElementById('modalRequirements');
        requirementsList.innerHTML = data.requirements.map(req => `
            <li class="flex items-start gap-3">
                <div class="mt-1.5 w-1.5 h-1.5 rounded-full bg-slate-400 dark:bg-zinc-600 flex-shrink-0"></div>
                <p class="text-[15px] text-slate-600 dark:text-zinc-300">${req}</p>
            </li>
        `).join('');
        
        // Prevent scroll jump by calculating scrollbar width
        const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;
        document.body.style.paddingRight = scrollbarWidth + 'px';
        document.body.style.overflow = 'hidden';
        
        // Show modal
        modal.classList.remove('hidden');
    }

    function closeDetails() {
        const modal = document.getElementById('detailsModal');
        const modalSheet = document.getElementById('modalSheet');
        modalSheet.style.transform = '';
        modalSheet.style.transition = 'transform 0.3s';
        modal.classList.add('hidden');
        document.body.style.overflow = '';
        document.body.style.paddingRight = '';
    }

    // Handle drag to close functionality
    let startY = 0;
    let currentY = 0;
    let isDragging = false;

    // Use DOMContentLoaded to wait for elements
    document.addEventListener('DOMContentLoaded', () => {
        const modalHandle = document.getElementById('modalHandle');
        const modalSheet = document.getElementById('modalSheet');

        if (modalHandle && modalSheet) {
            modalHandle.addEventListener('touchstart', (e) => {
                startY = e.touches[0].clientY;
                isDragging = true;
                modalSheet.style.transition = 'none';
            });

            modalHandle.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                currentY = e.touches[0].clientY;
                const diff = currentY - startY;
                
                // Only allow dragging down
                if (diff > 0) {
                    modalSheet.style.transform = `translateY(${diff}px)`;
                }
            });

            modalHandle.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                
                isDragging = false;
                const diff = currentY - startY;
                
                modalSheet.style.transition = 'transform 0.3s';
                
                // Close if dragged down more than 150px
                if (diff > 150) {
                    closeDetails();
                } else {
                    // Snap back to original position
                    modalSheet.style.transform = 'translateY(0)';
                }
            });

            // Also support mouse dragging for desktop
            modalHandle.addEventListener('mousedown', (e) => {
                startY = e.clientY;
                isDragging = true;
                modalSheet.style.transition = 'none';
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                currentY = e.clientY;
                const diff = currentY - startY;
                
                if (diff > 0) {
                    modalSheet.style.transform = `translateY(${diff}px)`;
                }
            });

            document.addEventListener('mouseup', (e) => {
                if (!isDragging) return;
                
                isDragging = false;
                const diff = currentY - startY;
                
                modalSheet.style.transition = 'transform 0.3s';
                
                if (diff > 150) {
                    closeDetails();
                } else {
                    modalSheet.style.transform = 'translateY(0)';
                }
            });
        }
    });

    // Sign up functionality with loading and confetti
    function signUpVolunteer() {
        const signUpModal = document.getElementById('signUpModal');
        const loadingState = document.getElementById('loadingState');
        const successState = document.getElementById('successState');
        
        // Show modal with loading state
        signUpModal.classList.remove('hidden');
        signUpModal.classList.add('flex');
        loadingState.classList.remove('hidden');
        successState.classList.add('hidden');
        
        // Simulate API call - show success after 2 seconds
        setTimeout(() => {
            loadingState.classList.add('hidden');
            successState.classList.remove('hidden');
            
            // Trigger confetti
            launchConfetti();
        }, 2000);
    }

    function closeSignUpModal() {
        const signUpModal = document.getElementById('signUpModal');
        signUpModal.classList.add('hidden');
        signUpModal.classList.remove('flex');
    }

    // Confetti animation
    function launchConfetti() {
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        canvas.classList.remove('hidden');
        
        const confettiCount = 150;
        const confetti = [];
        const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899'];
        
        // Create confetti particles
        for (let i = 0; i < confettiCount; i++) {
            confetti.push({
                x: canvas.width / 2,
                y: canvas.height / 2,
                r: Math.random() * 6 + 4,
                dx: (Math.random() - 0.5) * 8,
                dy: (Math.random() - 0.5) * 8 - 5,
                rotation: Math.random() * 360,
                rotationSpeed: (Math.random() - 0.5) * 10,
                color: colors[Math.floor(Math.random() * colors.length)],
                gravity: 0.3,
                opacity: 1
            });
        }
        
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            let activeConfetti = 0;
            
            confetti.forEach((c, index) => {
                if (c.opacity <= 0) return;
                
                activeConfetti++;
                
                ctx.save();
                ctx.globalAlpha = c.opacity;
                ctx.translate(c.x, c.y);
                ctx.rotate((c.rotation * Math.PI) / 180);
                ctx.fillStyle = c.color;
                ctx.fillRect(-c.r / 2, -c.r / 2, c.r, c.r);
                ctx.restore();
                
                // Update position
                c.x += c.dx;
                c.y += c.dy;
                c.dy += c.gravity;
                c.rotation += c.rotationSpeed;
                
                // Fade out when falling
                if (c.y > canvas.height / 2) {
                    c.opacity -= 0.01;
                }
            });
            
            if (activeConfetti > 0) {
                requestAnimationFrame(animate);
            } else {
                canvas.classList.add('hidden');
            }
        }
        
        animate();
    }
</script>
    <script src="../script.js"></script>
</body>
</html>
